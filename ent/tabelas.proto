edition = "2023";

import "ent/comum.proto";
import "ent/acoes.proto";

package ent;
option java_package = "com.matferib.Tabuleiro.ent";

enum TipoArmadura {
  TA_LEVE = 0;
  TA_MEDIO = 1;
  TA_PESADO = 2;
}

message RacaProto {
  string id = 1;
  string nome = 2;
  string descricao = 3;
  Atributos bonus_atributos = 4;
  repeated InfoPericia bonus_pericias = 9;
  TamanhoEntidade tamanho = 5 [default=TM_MEDIO];
  DadosDefesa dados_defesa = 6;
  TipoDnD tipo = 7;
  SubTipoDnD sub_tipo = 8;
  repeated DadosAtaque dados_ataque = 10;
  DadosAtaqueGlobal dados_ataque_global = 15;
  Movimento movimento = 11;
  TipoVisao tipo_visao = 12;
  float alcance_visao_m = 13;
  // Para raças estaveis como anões.
  bool estabilidade = 14;
  repeated TalentoProto talentos_com_complemento_automaticos = 16;
  repeated string familiaridade_com_arma = 17;
}

message ArmaduraOuEscudoProto {
  string nome = 1;
  Moedas preco = 2;
  int32 bonus = 3;
  int32 max_bonus_destreza = 4 [default = 100];
  TipoArmadura tipo = 5;
  int32 falha_arcana = 6;  // de 0 a 100.
  bool reduz_movimento = 7;
  int32 peso_kg = 8;
  // Valor eh positivo.
  int32 penalidade_armadura = 9;
  // Identificador unico, sem caracteres especiais para mapeamento em tabelas.
  string id = 10;
}

// Para efeitos de perícia, a arma pode ter apenas uma categoria.
enum CategoriaPericia {
  CATPER_SIMPLES = 0;
  CATPER_COMUM   = 1;
  CATPER_EXOTICA = 2;
  CATPER_EXOTICA_ARMA_FOGO = 3;
}

// Atencao: os valores aqui sao usados em mapas do dado de ataque global. Nao mudar.
// Uma arma pode ter varias categorias.
enum CategoriaArma {
  // arma corpo a corpo.
  CAT_CAC        = 0;
  // Ataque a distancia.
  CAT_DISTANCIA  = 1;
  // Arma leve.
  CAT_LEVE       = 2;
  // Arma de arremesso (implica distancia).
  CAT_ARREMESSO = 5;
  // Arma requer duas maos.
  CAT_DUAS_MAOS = 6;
  // Arcos tem tratamento especial (implica distancia).
  CAT_ARCO      = 7;
  // Arma é dupla. Implica duas maos.
  CAT_ARMA_DUPLA = 8;
  // A arma é um projétil de área (água benta, ácido, fogo alquimico).
  CAT_PROJETIL_AREA = 9;
  // O proto representa uma arma (e não um feitiço, por exemplo).
  CAT_ARMA = 10;
  // O proto representa uma arma natural.
  CAT_ARMA_NATURAL = 11;
}

enum TipoDano {
  TD_CORTANTE = 0;
  TD_CONCUSSAO = 1;
  TD_PERFURANTE = 2;
  TD_OUTRO = 3;
}

// O medio vem de tabela e os outros gerados automaticamente.
message StringPorTamanho {
  string minusculo = 8;
  string diminuto = 9;
  string miudo = 10;
  string pequeno = 2;
  string medio = 1;
  string grande = 3;
  string enorme = 5;
  string imenso = 6;
  string colossal = 7;
  // Dano nao varia por tamanho.
  string invariavel = 4;
}

enum TipoCarregamento {
  TC_LIVRE = 0;
  TC_MOVIMENTO = 1;
  TC_PADRAO = 3;
  TC_RODADA_COMPLETA = 2;
}

enum TipoComponenteMaterial {
  COMP_NENHUM = 0;
  COMP_FOCO = 1;
  COMP_MATERIAL = 2;
}

message InfoComponente {
  TipoComponenteMaterial tipo = 1;
  Moedas custo = 2;
  string descricao = 3;
  bool verbal = 4 [default=true];
  bool somatico = 5 [default=true];
  bool material = 6 [default=true];
}

// Proximo id: 42.
message ArmaProto {
  string id = 1;
  string id_arma_base = 39;
  string nome = 2;
  repeated CategoriaArma categoria = 3;
  string preco = 4;
  StringPorTamanho dano = 5;
  // Presente em armas duplas.
  StringPorTamanho dano_secundario = 6;
  StringPorTamanho peso = 8;
  repeated TipoDano tipo_dano = 9;
  // Algumas armas tem dano perfurante, mas o movimento é de outro tipo.
  TipoDano tipo_movimento_acao = 41;
  int32 alcance_quadrados = 10;
  // Para armas como chicote e corrente com cravos.
  bool atinge_adjacentes = 17;
  int32 multiplicador_haste = 37 [default=2];
  enum ModificadorAlcance {
    MOD_NENHUM = 0;
    MOD_2_QUAD_NIVEL = 1;
    MOD_8_QUAD_NIVEL = 2;
    MOD_1_QUAD_CADA_2_NIVEIS = 3;
  }
  ModificadorAlcance modificador_alcance = 22;
  int32 margem_critico = 7 [default=20];
  int32 multiplicador_critico = 11 [default=2];
  //int32 margem_critico_secundario = 12 [default=20];
  reserved 12;
  int32 multiplicador_critico_secundario = 13 [default=2];
  // Maximo modificador de forca permitido pela arma (valido para arcos).
  int32 max_forca = 14;
  CategoriaPericia categoria_pericia = 15;
  // Indica que a arma eh de haste.
  bool haste = 16;
  bool nao_letal = 18;
  // Para projeteis de area.
  string dano_dispersao = 19;
  // Para outros efeitos.
  AcaoProto acao = 20;
  // Em caso de feitico, indica quais classes podem usa-lo e o nivel.
  message InfoClasseParaFeitico {
    // Classe que pode usar o feitico, ou id do dominio.
    string id = 1;
    // Para feiticos de dominio.
    bool dominio = 2;
    // Nivel da classe.
    int32 nivel = 3;
  }
  repeated InfoClasseParaFeitico info_classes = 21;

  // Se a arma for criada por um feitico. Esses modelos devem ser usados apenas para
  // criar coisas nos DadosAtaque, ja que as ações serão sobrescritas no recomputa.
  ModeloGenerico modelo_limite_vezes = 23;

  enum ModeloDano {
    DANO_1D6_POR_NIVEL_MAX_10D6 = 0;
    CURA_1D8_MAIS_1_POR_NIVEL_MAX_5 = 1;
    DANO_1D8_MAIS_1_POR_NIVEL_MAX_5 = 2;
    CURA_2D8_MAIS_1_POR_NIVEL_MAX_10 = 3;
    DANO_2D8_MAIS_1_POR_NIVEL_MAX_10 = 4;
    CURA_3D8_MAIS_1_POR_NIVEL_MAX_15 = 5;
    DANO_3D8_MAIS_1_POR_NIVEL_MAX_15 = 6;
    CURA_4D8_MAIS_1_POR_NIVEL_MAX_20 = 7;
    DANO_4D8_MAIS_1_POR_NIVEL_MAX_20 = 8;
    DANO_1D8_CADA_2_NIVEIS_MAX_5D8 = 9;
    DANO_1D8_POR_NIVEL_MAX_10D8 = 10;
    DANO_1D6_CADA_2_NIVEIS_MAX_5D6 = 11;
    DANO_1D8_CADA_2_NIVEIS_MAX_10D8 = 12;
    CURA_1= 13;
    DANO_1= 14;
    DANO_1D4_POR_NIVEL_MAX_5D4 = 15;
    DANO_1D6_POR_NIVEL_MAX_15D6 = 16;
    DANO_3D6_MAIS_1_POR_NIVEL = 17;
    CURA_10_POR_NIVEL_MAX_150 = 18;
    DANO_10_POR_NIVEL_MAX_150 = 19;
    DANO_1D6_POR_NIVEL_MAX_20D6 = 20;
  }
  // Se a arma for criada por feitico.
  ModeloDano modelo_dano = 25;

  // Arma requer carregamento.
  message Carregamento {
    bool requer_carregamento = 1;
    // O tipo de carregamento da arma.
    TipoCarregamento tipo_carregamento = 2;
    // A capacidade de carga antes de ter que carregar (besta de repeticao).
    int32 capacidade_carga = 3;
  }
  Carregamento carregamento = 24;

  // Arma possui veneno.
  VenenoProto veneno = 27;

  // A arma requer ataque de toque.
  bool ataque_toque = 26;
  // Alguns feiticos dao dano independente da salvacao (explosao sonora). Apenas os efeitos sao anulados pela salvacao.
  bool dano_ignora_salvacao = 28;
  string escola = 29;
  enum ModeloTotalDadosVida {
    TDV_NENHUM = 0;
    TDV_2D4_MAIS_NIVEL = 1;
    TDV_1D4_POR_NIVEL_MAX_20D4 = 2;
  };
  ModeloTotalDadosVida modelo_total_dv = 30;
  // link da arma, feitico ou o que for.
  string link = 32;
  string nome_ingles = 33;
  // Caso a arma tenha modelo 3d.
  string modelo_3d = 31 [deprecated=true];
  Modelo3d info_modelo_3d = 34;
  // Se verdadeiro, arma pode ser usada para derrubar.
  bool pode_derrubar = 35;
  int32 bonus_desarmar = 40;
  InfoComponente componente = 36;
  // tempo_conjuracao, casting_time;
  int32 tempo_execucao_rodadas = 38;
}

message TabelaArmaduraOuEscudo {
  repeated ArmaduraOuEscudoProto armaduras = 1;
  repeated ArmaduraOuEscudoProto escudos = 2;
}

message TabelaArmas {
  repeated ArmaProto armas = 1;
}

message TabelaFeiticos {
  repeated ArmaProto armas = 1;
}

message TabelaEfeitos {
  repeated EfeitoProto efeitos = 1;
}

message TabelaEfeitosModelos {
  repeated EfeitoModeloProto efeitos = 1;
}

message TabelaPocoes {
  repeated ItemMagicoProto pocoes = 1;
}

message TabelaPergaminhos {
  repeated ItemMagicoProto pergaminhos_arcanos = 1;
  repeated ItemMagicoProto pergaminhos_divinos = 2;
}

message TabelaVarinhas {
  repeated ItemMagicoProto varinhas = 1;
}

message TabelaTalentos {
  repeated TalentoProto talentos = 1;
}

message TabelaClasses {
  repeated InfoClasse info_classes = 1;
}

message TabelaPericias {
  repeated PericiaProto pericias = 1;
}

message TabelaAneis {
  repeated ItemMagicoProto aneis = 1;
}

message TabelaMantos {
  repeated ItemMagicoProto mantos = 1;
}

message TabelaBotas {
  repeated ItemMagicoProto botas = 1;
}

message TabelaMunicoes {
  repeated Municao municoes = 1;
}

message TabelaItensMundanos {
  repeated ItemMagicoProto itens = 1;
}

message TabelaItensMaravilhosos {
  repeated ItemMagicoProto itens = 1;
}

message TabelaBracadeiras {
  repeated ItemMagicoProto bracadeiras = 1;
}

message TabelaLuvas {
  repeated ItemMagicoProto luvas = 1;
}

message TabelaAmuletos {
  repeated ItemMagicoProto amuletos = 1;
}

message TabelaChapeus {
  repeated ItemMagicoProto chapeus = 1;
}

message TabelaVenenos {
  repeated VenenoProto venenos = 1;
}

message TabelaDoencas {
  repeated DoencaProto doencas = 1;
}

message TabelaRacas {
  repeated RacaProto racas = 1;
}

message DominioProto {
  string id = 1;
  string nome = 2;
  string descricao = 3;
  repeated DadosAtaque dados_ataque = 4;
}

message TabelaDominios {
  repeated DominioProto dominios = 1;
}

// O arquivo tabelas.asciiproto eh desse tipo.
message TodasTabelas {
  TabelaArmaduraOuEscudo tabela_armaduras = 1;
  TabelaArmaduraOuEscudo tabela_escudos = 2;
  TabelaArmas tabela_armas = 3;
  TabelaEfeitos tabela_efeitos = 4;
  TabelaTalentos tabela_talentos = 5;
  TabelaPericias tabela_pericias =  6;
  TabelaFeiticos tabela_feiticos = 7;
  TabelaEfeitosModelos tabela_efeitos_modelos = 8;
  TabelaRacas tabela_racas = 9;
  TabelaPocoes tabela_pocoes = 50;
  TabelaPergaminhos tabela_pergaminhos = 61;
  TabelaClasses tabela_classes =  51;
  TabelaAneis tabela_aneis = 52;
  TabelaMantos tabela_mantos = 53;
  TabelaBotas tabela_botas = 54;
  TabelaBracadeiras tabela_bracadeiras = 55;
  TabelaLuvas tabela_luvas = 56;
  TabelaAmuletos tabela_amuletos = 58;
  TabelaChapeus tabela_chapeus = 59;
  TabelaVenenos tabela_venenos = 57;
  TabelaDoencas tabela_doencas = 65;
  TabelaDominios tabela_dominios = 60;
  TabelaMunicoes tabela_municoes = 62;
  TabelaItensMundanos tabela_itens_mundanos = 63;
  TabelaVarinhas tabela_varinhas = 64;
  TabelaItensMaravilhosos tabela_itens_maravilhosos = 66;
}
